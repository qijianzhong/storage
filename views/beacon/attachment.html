<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>tour attachment</title>
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/attachment/base.css">
    <link rel="stylesheet" type="text/css" href="../css/attachment/lib3a9ce3.css">
    <link rel="stylesheet" href="../css/attachment/appmsg_new3a7b39.css" media="all">
    <link rel="stylesheet" type="text/css" href="../css/attachment/tooltip3a7b39.css">
    <link rel="stylesheet" type="text/css" href="../css/attachment/jquery.scrollbar3a7b39.css">
    <link rel="stylesheet" type="text/css" href="../css/attachment/image_list3a7ad2.css">





    <style>
        .appmsg_input_area {
            position: relative;
            /* margin: 0px 211px 0px 0; */
            margin: 0;
            /* padding-top: 50px; */
        }

        .appmsg_input_area .editor_area .split_line {
            margin: 0 20px;
        }

        /* body.edit_fixed .appmsg_edit_container{
            top: 45px;
        } */

        .kv-file-content {

            border: 0px solid #ddd;
            box-shadow: 1px 1px 5px 0 #a2958a;
            width: calc(100% - 13px);
            float: left;
            text-align: center;
            padding: 6px;
        }

        .kv-file-content:hover {
            box-shadow: 3px 3px 5px 0 #333;
        }

        .langsdivcss {
            width: 100%;
        }

        .dropdown-menu>li>a {
            width: 100%;
            color: #887a7a;
        }

        .dropdown-menu>.active>a.fillexcite,
        .dropdown-menu>.active>a.fillexcite:focus,
        .dropdown-menu>.active>a.fillexcite:hover {
            color: #fff;
            text-decoration: none;
            background-color: #337ab7;
            outline: 0;
        }

        .dropdown-menu>li>a.fillexcite:focus,
        .dropdown-menu>li>a.fillexcite:hover {
            color: #262626;
            text-decoration: none;
            background-color: #f5f5f5;
        }

        .dropdown-menu>li>a.fillexcite {
            color: #3f8c65;
        }

        /* .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        } */

        .appmsg_tpl_area .tpl_item.active {
            border: 1px solid #43b548;
            margin: 0 -1px -1px;
            position: relative;
            z-index: 1;
            color: #43b548;
            zoom: 1;
        }

        textarea::-webkit-scrollbar,
        html::-webkit-scrollbar,
        #body::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        textarea::-webkit-scrollbar-button,
        html::-webkit-scrollbar-button,
        #body::-webkit-scrollbar-button {
            display: none;
        }

        textarea::-webkit-scrollbar-track,
        html::-webkit-scrollbar-track,
        #body::-webkit-scrollbar-track {
            /*外层轨道，可以用display:none让其不显示，也可以添加背景图片，颜色改变显示效果（位置3）*/
            display: none;
        }

        textarea::-webkit-scrollbar-track-piece,
        html::-webkit-scrollbar-track-piece,
        #body::-webkit-scrollbar-track-piece {
            /*内层轨道，滚动条中间部分（位置4）*/
            background-color: #fff;
        }

        /* textarea::-webkit-scrollbar-thumb, */

        html::-webkit-scrollbar-thumb,
        #body::-webkit-scrollbar-thumb {
            /*滚动条里面可以拖动的那部分（位置5）*/
            background-color: #c2c2c2;
            background-clip: padding-box;
            border-radius: 3px;
            min-height: 28px;
        }

        textarea.frm_textarea {
            overflow: hidden;
        }

        #imgpreviewUL li:hover .cbp-vm-add {
            padding: 0px;
            display: block;
            position: absolute;
            border-radius: 50%;
            bottom: 4px;
            right: 10px;
            height: 30px;
            width: 30px;
            line-height: 30px;
            text-align: center;
            color: #fff;
            background: #40b882;
            /* background: rgb(71, 163, 218); */
        }

        #imgpreviewUL li .cbp-vm-add {
            display: none;
        }

        @font-face {
            font-family: 'Glyphicons Halflings';
            src: url(../fonts/glyphicons-halflings-regular.eot);
            src: url(../fonts/glyphicons-halflings-regular.eot?#iefix) format('embedded-opentype'), url(../fonts/glyphicons-halflings-regular.woff2) format('woff2'), url(../fonts/glyphicons-halflings-regular.woff) format('woff'), url(../fonts/glyphicons-halflings-regular.ttf) format('truetype'), url(../fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular) format('svg')
        }

        .glyphicon {
            position: relative;
            top: 1px;
            display: inline-block;
            font-family: 'Glyphicons Halflings';
            font-style: normal;
            font-weight: 400;
            line-height: 1;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .glyphicon-trash:before {
            content: "\e020";
            font-size: 12px;
        }

        /* #imgpreviewUL li:hover {
            border: 1px solid #40b882;
            border-radius: 5px;
        } */

        .btn.btn_upload {
            height: 100%;
        }

        .weui-desktop-img-picker__item {
            width: 172px;
        }

        .file-audio-content {
            display: inline-block;
            height: 100%;
            width: auto;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            word-wrap: normal;
            margin-right: 1em;
            vertical-align: middle;
        }

        /* .file-audio-content:hover {
            text-overflow:inherit;
overflow:visible;
        } */

        .file-audio-content .audioplay {
            background: url('../images/lALPBbCc1U0jX7ZkZA_100_100.png');
            height: 100%;
            background-size: 100%;
        }

        .file-audio-content .audiopause {
            background: url('../images/lALPBbCc1U0iPWNkZA_100_100.png');
            height: 100%;
            background-size: 100%;
        }

        #langsdrop:hover {
            color: #f8991d;
        }

        #langsdrop {
            color: #333;
            list-style-type: none;
            text-decoration: none;
            cursor: pointer;
        }

        ul .disnone {
            display: none;
        }

        li.tpl_item {
            width: 100%;
        }

        li.tpl_item a {
            padding: 5px 20px;
        }

        #audiocontainer1.js_show_cover_pic_tips,
        #audiocontainer2.js_show_cover_pic_tips,
        #audiocontainer3.js_show_cover_pic_tips,
        #audiocontainer4.js_show_cover_pic_tips,
        #audiocontainer5.js_show_cover_pic_tips,
        #audiocontainer6.js_show_cover_pic_tips,
        #audiocontainer7.js_show_cover_pic_tips {
            height: 88px;
        }

        .weui-desktop-img-picker__img-title {
            padding: 0 10px;
        }

        .container-fluid {
            height: 48px;
        }

        .nav-pills a {
            margin-top: 4px;
        }

        .js_btn_p button[disabled] {
            cursor: not-allowed;
        }
    </style>
</head>

<body class="zh_CN weui-desktop-page_simple page_appmsg_new edit_fixed" style="padding:50px 15px 0">
    <header class="header">
        <nav class="navbar navbar-default navbar-fixed-top" id="myScrollspy" role="navigation" style="right: 0px;left: 0px;border-radius: 0px;">
            <div class="container-fluid" style="position: relative;">
                <div style="display: inline-block;">
                    <ul class="nav nav-pills " id="scrollbarlocal1">
                        <li class="active scrollLi1">
                            <a id="scroll1" href="#beacon_right_1">
                                <%= lang.text %>
                            </a>
                        </li>
                        <li class="scrollLi1">
                            <a id="scroll2" href="#audioprelocal1">
                                <%= lang.audio %>
                            </a>
                        </li>
                        <li>
                            <a href="#imgprelocal">
                                <%= lang.image %>
                            </a>
                        </li>
                    </ul>
                </div>

                <span class="btn btn_input js_btn_p btn-primary btn_disabled" style="float:  right;right: 100px;top: 8px;position:  absolute;">
                    <button type="button" class="js_btn" data-urlid="" data-index="0" disabled id="saveattachment">
                        Save
                    </button>
                </span>

                <div class="dropdown navbar-right" style="margin:0;line-height: 48px;position: absolute; top: 0; right: 15px;">
                    <a class="dropdown-toggle" id="langsdrop" data-toggle="dropdown" data-lang="chinese" aria-expanded="false">
                        中文
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu " id="langs" style="min-width: 130px;">
                        <!-- <li class="tpl_item active" data-index="1" data-lang="chinese" tabindex="-1">
                            <a href="#beacon_right_1" class="langsdivcss" data-toggle="tab" aria-expanded="true">
                                中文</a>
                        </li>
                        <li class="tpl_item " data-index="2" data-lang="english" tabindex="-1">
                            <a href="#beacon_right_2" class="langsdivcss" data-toggle="tab" aria-expanded="false">
                                English</a>
                        </li>
                        <li class="tpl_item " data-index="3" data-lang="japanese" tabindex="-1">
                            <a href="#beacon_right_3" class="langsdivcss" data-toggle="tab" aria-expanded="false">
                                日本語</a>
                        </li>
                        <li class="tpl_item " data-index="4" data-lang="portuguese" tabindex="-1">
                            <a href="#beacon_right_4" class="langsdivcss" data-toggle="tab" aria-expanded="false">
                                Português</a>
                        </li>
                        <li class="tpl_item " data-index="5" data-lang="russian" tabindex="-1">
                            <a href="#beacon_right_5" class="langsdivcss" data-toggle="tab" aria-expanded="false">
                                Русский</a>
                        </li>
                        <li class="tpl_item " data-index="6" data-lang="france" tabindex="-1">
                            <a href="#beacon_right_6" class="langsdivcss" data-toggle="tab" aria-expanded="false">
                                Français</a>
                        </li>
                        <li class="tpl_item " data-index="7" data-lang="german" tabindex="-1">
                            <a href="#beacon_right_7" class="langsdivcss" data-toggle="tab" aria-expanded="false">
                                Deutsch</a>
                        </li> -->
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div id="body" class="mp-body " style="overflow: auto;height:550px;" data-content="" data-target="#myScrollspy">
        <div class="weui-desktop-layout weui-desktop-layout_global">
            <div class="weui-desktop-layout__main">
                <div class="js_main_inner weui-desktop-layout__main__area">
                    <div class="js_main_inner weui-desktop-layout__main__inner">
                        <div class="weui-desktop-layout__main__bd weui-desktop-panel main_bd">
                            <div class="appmsg_edit_box">

                                <form id="form_tourbeacon_attachment" onsubmit="return false">
                                    <div id="editor_pannel" class="appmsg_edit_mod primary appmsg_input_area">
                                        <div id="js_appmsg_editor" class="appmsg_editor_wrp">
                                            <div class="appmsg_editor">
                                                <div class="appmsg_editor_inner">
                                                    <!-- BEGIN UEDITOR -->
                                                    <div id="js_ueditor" class="appmsg_edit_item content_edit">
                                                        <label for="" class="frm_label" style="display:none;">
                                                            <strong class="title">正文</strong>
                                                            <p class="tips l">
                                                                <em id="js_auto_tips"></em>
                                                                <a id="js_cancle" style="display:none;" href="javascript:void(0);" onclick="return false;">取消</a>
                                                            </p>
                                                        </label>
                                                        <div id="js_editor" class="edui_editor_wrp edui-default">
                                                            <div class=" edui-default">
                                                                <div id="edui1" class="tab-content edui-editor  edui-default" style="z-index: 999;">
                                                                    <!-- 标题报错 -->
                                                                    <div class="page_msg mini with_closed js_title_error js_error_msg edui-default" style="display:none;">
                                                                        <div class="inner edui-default">
                                                                            <span class="msg_icon_wrp edui-default">
                                                                                <i class="icon_msg_mini info edui-default"></i>
                                                                            </span>
                                                                            <div class="msg_content edui-default">
                                                                                <p class="js_msg_content edui-default">
                                                                                    标题不能为空且长度不能超过64字 </p>
                                                                            </div>
                                                                        </div>
                                                                        <span class="msg_closed js_msg_close edui-default">关闭</span>
                                                                    </div>

                                                                    <input type="hidden" id="beacon_id" name="beacon_id" value="">

                                                                    <!-- chinese -->
                                                                    <div id="beacon_right_1" class="tab-pane fade active in ">
                                                                        <!-- 标题 -->
                                                                        <div class="js_title_main appmsg_edit_item title frm_input_box edui-default with_counter counter_in append count" id="titleprelocal1">
                                                                            <label for="title" class="tips_global placeholder_tips edui-default" style="display:none">请在这里输入标题</label>
                                                                            <input id="chinese_title" name="chinese_title" type="text" placeholder="<%= lang.please_enter_a_title_here %>" class="frm_input js_title js_counter js_field edui-default"
                                                                                max-length="64">
                                                                            <input type="hidden" id="chinese_id" name="chinese_id" value="">
                                                                            <em class="frm_input_append frm_counter" style="display: none;">0/64</em>
                                                                        </div>
                                                                        <!-- 外部Url地址 -->
                                                                        <!-- <div class="js_reprint_hide appmsg_edit_item author frm_input_box edui-default with_counter counter_in append count">
                                                                            <label for="author" class="tips_global placeholder_tips edui-default" style="display:none">请输入外部Url</label>
                                                                            <input id="author" type="text" placeholder="请输入外部Url" class="frm_input js_author js_counter js_field edui-default" name="author">
                                                                        </div> -->

                                                                        <!-- 正文 -->
                                                                        <div class="editor_area edui-default">
                                                                            <div class="split_line edui-default"></div>
                                                                            <!-- 正文报错 -->

                                                                            <div class="edui-editor-iframeholder js_reprint_hide edui-default" style="padding: 20px;">
                                                                                <textarea id="chinese_content" name="chinese_contentText" placeholder="<%= lang.write_the_text_from_here %>" class="frm_textarea js_desc js_counter js_field"
                                                                                    max-length="1000" style="height: 236px;"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <!-- EBGIN 音频 -->
                                                                        <div id="audioprelocal1" class="appmsg_edit_item gap_left audio" style="padding-top: 20px;border-top: 1px solid #e7e7eb;">
                                                                            <label for="" class="frm_label">
                                                                                <strong class="title">
                                                                                    <%= lang.audio %>
                                                                                </strong>
                                                                                <p class="js_cover_tip tips gap_left"></p>
                                                                            </label>
                                                                            <div class="upload_wrap">
                                                                                <div class="js_reprint_hide">
                                                                                    <div class="upload_box  align_right">
                                                                                        <span class="upload_area webuploader-container">
                                                                                            <a id="" class="btn btn-primary js_audioupload" data-groupid="">
                                                                                                <%= lang.upload_local %>
                                                                                            </a>
                                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                                <input id="input-chinese" type="file" accept="audio/basic,audio/x-aiff,audio/x-mpeg,audio/x-pn/realaudio,audio/x-waw" style="display: none;">
                                                                                                <input type="hidden" id="chinese_audiourl" name="chinese_audiourl" value="">
                                                                                                <label for="input-chinese" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                                            </div>
                                                                                        </span>
                                                                                    </div>
                                                                                    &nbsp;&nbsp;
                                                                                    <a id="js_audio1dialog" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">
                                                                                        <%= lang.choose_from_audio_library %>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                            <div id="audiocontainer1" class="js_show_cover_pic_tips" style="border:1px solid #e7e7eb;margin-top:10px;padding:6px;">
                                                                                <span class="tips js_msg_content">
                                                                                    <%= lang.audio_display_area %>
                                                                                </span>

                                                                            </div>
                                                                        </div>
                                                                        <!-- END 音频 -->
                                                                    </div>

                                                                    <!-- english -->
                                                                    <div id="beacon_right_2" class="tab-pane fade ">
                                                                        <!-- 标题 -->
                                                                        <div class="js_title_main appmsg_edit_item title frm_input_box edui-default with_counter counter_in append count" id="titleprelocal2">
                                                                            <label for="title" class="tips_global placeholder_tips edui-default" style="display:none">Please enter a title here</label>
                                                                            <input id="english_title" name="english_title" type="text" placeholder="<%= lang.please_enter_a_title_here %>" class="frm_input js_title js_counter js_field edui-default"
                                                                                max-length="64">
                                                                            <input type="hidden" id="english_id" name="english_id" value="">
                                                                            <em class="frm_input_append frm_counter" style="display: none;">0/64</em>
                                                                        </div>

                                                                        <!-- 正文 -->
                                                                        <div class="editor_area edui-default">
                                                                            <div class="split_line edui-default"></div>
                                                                            <!-- 正文报错 -->

                                                                            <div class="edui-editor-iframeholder js_reprint_hide edui-default" style="padding: 20px;">
                                                                                <textarea id="english_content" name="english_contentText" placeholder="<%= lang.write_the_text_from_here %>" class="frm_textarea js_desc js_counter js_field"
                                                                                    max-length="1000" style="height: 236px;"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <!-- EBGIN 音频 -->
                                                                        <div id="audioprelocal2" class="appmsg_edit_item gap_left audio" style="padding-top: 20px;border-top: 1px solid #e7e7eb;">
                                                                            <label for="" class="frm_label">
                                                                                <strong class="title">
                                                                                    <%= lang.audio %>
                                                                                </strong>
                                                                                <p class="js_cover_tip tips gap_left"></p>
                                                                            </label>
                                                                            <div class="upload_wrap">
                                                                                <div class="js_reprint_hide">
                                                                                    <div class="upload_box  align_right">
                                                                                        <span class="upload_area webuploader-container">
                                                                                            <a id="" class="btn btn-primary js_audioupload" data-groupid="">
                                                                                                <%= lang.upload_local %>
                                                                                            </a>
                                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                                <input id="input-english" type="file" accept="audio/basic,audio/x-aiff,audio/x-mpeg,audio/x-pn/realaudio,audio/x-waw" style="display: none;">
                                                                                                <input type="hidden" id="english_audiourl" name="english_audiourl" value="">
                                                                                                <label for="input-english" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                                            </div>
                                                                                        </span>
                                                                                    </div>
                                                                                    &nbsp;&nbsp;
                                                                                    <a id="js_audio2dialog" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">
                                                                                        <%= lang.choose_from_audio_library %>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                            <div id="audiocontainer2" class="js_show_cover_pic_tips" style="border:1px solid #e7e7eb;margin-top:10px;padding:6px;">
                                                                                <span class="tips js_msg_content">
                                                                                    <%= lang.audio_display_area %>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                        <!-- END 音频 -->
                                                                    </div>

                                                                    <!-- japanese -->
                                                                    <div id="beacon_right_3" class="tab-pane fade ">
                                                                        <!-- 标题 -->
                                                                        <div class="js_title_main appmsg_edit_item title frm_input_box edui-default with_counter counter_in append count" id="titleprelocal3">
                                                                            <label for="title" class="tips_global placeholder_tips edui-default" style="display:none">ここにタイトルを入力してください</label>
                                                                            <input id="japanese_title" name="japanese_title" type="text" placeholder="<%= lang.please_enter_a_title_here %>" class="frm_input js_title js_counter js_field edui-default"
                                                                                max-length="64">
                                                                            <input type="hidden" id="japanese_id" name="japanese_id" value="">
                                                                            <em class="frm_input_append frm_counter" style="display: none;">0/64</em>
                                                                        </div>

                                                                        <!-- 正文 -->
                                                                        <div class="editor_area edui-default">
                                                                            <div class="split_line edui-default"></div>
                                                                            <!-- 正文报错 -->

                                                                            <div class="edui-editor-iframeholder js_reprint_hide edui-default" style="padding: 20px;">
                                                                                <textarea id="japanese_content" name="japanese_contentText" placeholder="<%= lang.write_the_text_from_here %>" class="frm_textarea js_desc js_counter js_field"
                                                                                    max-length="1000" style="height: 236px;"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <!-- EBGIN 音频 -->
                                                                        <div id="audioprelocal3" class="appmsg_edit_item gap_left audio" style="padding-top: 20px;border-top: 1px solid #e7e7eb;">
                                                                            <label for="" class="frm_label">
                                                                                <strong class="title">
                                                                                    <%= lang.audio %>
                                                                                </strong>
                                                                                <p class="js_cover_tip tips gap_left"></p>
                                                                            </label>
                                                                            <div class="upload_wrap">
                                                                                <div class="js_reprint_hide">
                                                                                    <div class="upload_box  align_right">
                                                                                        <span class="upload_area webuploader-container">
                                                                                            <a id="" class="btn btn-primary js_audioupload" data-groupid="">
                                                                                                <%= lang.upload_local %>
                                                                                            </a>
                                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                                <input id="input-japanese" type="file" accept="audio/basic,audio/x-aiff,audio/x-mpeg,audio/x-pn/realaudio,audio/x-waw" style="display: none;">
                                                                                                <input type="hidden" id="japanese_audiourl" name="japanese_audiourl" value="">
                                                                                                <label for="input-japanese" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                                            </div>
                                                                                        </span>
                                                                                    </div>
                                                                                    &nbsp;&nbsp;
                                                                                    <a id="js_audio3dialog" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">
                                                                                        <%= lang.choose_from_audio_library %>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                            <div id="audiocontainer3" class="js_show_cover_pic_tips" style="border:1px solid #e7e7eb;margin-top:10px;padding:6px;">
                                                                                <span class="tips js_msg_content">
                                                                                    <%= lang.audio_display_area %>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                        <!-- END 音频 -->
                                                                    </div>

                                                                    <!-- portuguese -->
                                                                    <div id="beacon_right_4" class="tab-pane fade ">
                                                                        <!-- 标题 -->
                                                                        <div class="js_title_main appmsg_edit_item title frm_input_box edui-default with_counter counter_in append count" id="titleprelocal4">
                                                                            <label for="title" class="tips_global placeholder_tips edui-default" style="display:none">Digite aqui um título</label>
                                                                            <input id="portuguese_title" name="portuguese_title" type="text" placeholder="<%= lang.please_enter_a_title_here %>" class="frm_input js_title js_counter js_field edui-default"
                                                                                max-length="64">
                                                                            <input type="hidden" id="portuguese_id" name="portuguese_id" value="">
                                                                            <em class="frm_input_append frm_counter" style="display: none;">0/64</em>
                                                                        </div>

                                                                        <!-- 正文 -->
                                                                        <div class="editor_area edui-default">
                                                                            <div class="split_line edui-default"></div>
                                                                            <!-- 正文报错 -->

                                                                            <div class="edui-editor-iframeholder js_reprint_hide edui-default" style="padding: 20px;">
                                                                                <textarea id="portuguese_content" name="portuguese_contentText" placeholder="<%= lang.write_the_text_from_here %>" class="frm_textarea js_desc js_counter js_field"
                                                                                    max-length="1000" style="height: 236px;"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <!-- EBGIN 音频 -->
                                                                        <div id="audioprelocal4" class="appmsg_edit_item gap_left audio" style="padding-top: 20px;border-top: 1px solid #e7e7eb;">
                                                                            <label for="" class="frm_label">
                                                                                <strong class="title">
                                                                                    <%= lang.audio %>
                                                                                </strong>
                                                                                <p class="js_cover_tip tips gap_left"></p>
                                                                            </label>
                                                                            <div class="upload_wrap">
                                                                                <div class="js_reprint_hide">
                                                                                    <div class="upload_box  align_right">
                                                                                        <span class="upload_area webuploader-container">
                                                                                            <a id="" class="btn btn-primary js_audioupload" data-groupid="">
                                                                                                <%= lang.upload_local %>
                                                                                            </a>
                                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                                <input id="input-portuguese" type="file" accept="audio/basic,audio/x-aiff,audio/x-mpeg,audio/x-pn/realaudio,audio/x-waw"
                                                                                                    style="display: none;">
                                                                                                <input type="hidden" id="portuguese_audiourl" name="portuguese_audiourl" value="">
                                                                                                <label for="input-portuguese" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                                            </div>
                                                                                        </span>
                                                                                    </div>
                                                                                    &nbsp;&nbsp;
                                                                                    <a id="js_audio4dialog" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">
                                                                                        <%= lang.choose_from_audio_library %>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                            <div id="audiocontainer4" class="js_show_cover_pic_tips" style="border:1px solid #e7e7eb;margin-top:10px;padding:6px;">
                                                                                <span class="tips js_msg_content">
                                                                                    <%= lang.audio_display_area %>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                        <!-- END 音频 -->
                                                                    </div>

                                                                    <!-- russian -->
                                                                    <div id="beacon_right_5" class="tab-pane fade ">
                                                                        <!-- 标题 -->
                                                                        <div class="js_title_main appmsg_edit_item title frm_input_box edui-default with_counter counter_in append count" id="titleprelocal5">
                                                                            <label for="title" class="tips_global placeholder_tips edui-default" style="display:none">Пожалуйста, введите название здесь</label>
                                                                            <input id="russian_title" name="russian_title" type="text" placeholder="<%= lang.please_enter_a_title_here %>" class="frm_input js_title js_counter js_field edui-default"
                                                                                max-length="64">
                                                                            <input type="hidden" id="russian_id" name="russian_id" value="">
                                                                            <em class="frm_input_append frm_counter" style="display: none;">0/64</em>
                                                                        </div>

                                                                        <!-- 正文 -->
                                                                        <div class="editor_area edui-default">
                                                                            <div class="split_line edui-default"></div>
                                                                            <!-- 正文报错 -->

                                                                            <div class="edui-editor-iframeholder js_reprint_hide edui-default" style="padding: 20px;">
                                                                                <textarea id="russian_content" name="russian_contentText" placeholder="<%= lang.write_the_text_from_here %>" class="frm_textarea js_desc js_counter js_field"
                                                                                    max-length="1000" style="height: 236px;"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <!-- EBGIN 音频 -->
                                                                        <div id="audioprelocal5" class="appmsg_edit_item gap_left audio" style="padding-top: 20px;border-top: 1px solid #e7e7eb;">
                                                                            <label for="" class="frm_label">
                                                                                <strong class="title">
                                                                                    <%= lang.audio %>
                                                                                </strong>
                                                                                <p class="js_cover_tip tips gap_left"></p>
                                                                            </label>
                                                                            <div class="upload_wrap">
                                                                                <div class="js_reprint_hide">
                                                                                    <div class="upload_box  align_right">
                                                                                        <span class="upload_area webuploader-container">
                                                                                            <a id="" class="btn btn-primary js_audioupload" data-groupid="">
                                                                                                <%= lang.upload_local %>
                                                                                            </a>
                                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                                <input id="input-russian" type="file" accept="audio/basic,audio/x-aiff,audio/x-mpeg,audio/x-pn/realaudio,audio/x-waw" style="display: none;">
                                                                                                <input type="hidden" id="russian_audiourl" name="russian_audiourl" value="">
                                                                                                <label for="input-russian" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                                            </div>
                                                                                        </span>
                                                                                    </div>
                                                                                    &nbsp;&nbsp;
                                                                                    <a id="js_audio5dialog" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">
                                                                                        <%= lang.choose_from_audio_library %>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                            <div id="audiocontainer5" class="js_show_cover_pic_tips" style="border:1px solid #e7e7eb;margin-top:10px;padding:6px;">
                                                                                <span class="tips js_msg_content">
                                                                                    <%= lang.audio_display_area %>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                        <!-- END 音频 -->
                                                                    </div>

                                                                    <!-- france -->
                                                                    <div id="beacon_right_6" class="tab-pane fade ">
                                                                        <!-- 标题 -->
                                                                        <div class="js_title_main appmsg_edit_item title frm_input_box edui-default with_counter counter_in append count" id="titleprelocal6">
                                                                            <label for="title" class="tips_global placeholder_tips edui-default" style="display:none">S'il vous plaît entrer un titre ici</label>
                                                                            <input id="france_title" name="france_title" type="text" placeholder="<%= lang.please_enter_a_title_here %>" class="frm_input js_title js_counter js_field edui-default"
                                                                                max-length="64">
                                                                            <input type="hidden" id="france_id" name="france_id" value="">
                                                                            <em class="frm_input_append frm_counter" style="display: none;">0/64</em>
                                                                        </div>

                                                                        <!-- 正文 -->
                                                                        <div class="editor_area edui-default">
                                                                            <div class="split_line edui-default"></div>
                                                                            <!-- 正文报错 -->

                                                                            <div class="edui-editor-iframeholder js_reprint_hide edui-default" style="padding: 20px;">
                                                                                <textarea id="france_content" name="france_contentText" placeholder="<%= lang.write_the_text_from_here %>" class="frm_textarea js_desc js_counter js_field"
                                                                                    max-length="1000" style="height: 236px;"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <!-- EBGIN 音频 -->
                                                                        <div id="audioprelocal6" class="appmsg_edit_item gap_left audio" style="padding-top: 20px;border-top: 1px solid #e7e7eb;">
                                                                            <label for="" class="frm_label">
                                                                                <strong class="title">
                                                                                    <%= lang.audio %>
                                                                                </strong>
                                                                                <p class="js_cover_tip tips gap_left"></p>
                                                                            </label>
                                                                            <div class="upload_wrap">
                                                                                <div class="js_reprint_hide">
                                                                                    <div class="upload_box  align_right">
                                                                                        <span class="upload_area webuploader-container">
                                                                                            <a id="" class="btn btn-primary js_audioupload" data-groupid="">
                                                                                                <%= lang.upload_local %>
                                                                                            </a>
                                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                                <input id="input-france" type="file" accept="audio/basic,audio/x-aiff,audio/x-mpeg,audio/x-pn/realaudio,audio/x-waw" style="display: none;">
                                                                                                <input type="hidden" id="france_audiourl" name="france_audiourl" value="">
                                                                                                <label for="input-france" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                                            </div>
                                                                                        </span>
                                                                                    </div>
                                                                                    &nbsp;&nbsp;
                                                                                    <a id="js_audio6dialog" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">
                                                                                        <%= lang.choose_from_audio_library %>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                            <div id="audiocontainer6" class="js_show_cover_pic_tips" style="border:1px solid #e7e7eb;margin-top:10px;padding:6px;">
                                                                                <span class="tips js_msg_content">
                                                                                    <%= lang.audio_display_area %>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                        <!-- END 音频 -->
                                                                    </div>

                                                                    <!-- german -->
                                                                    <div id="beacon_right_7" class="tab-pane fade ">
                                                                        <!-- 标题 -->
                                                                        <div class="js_title_main appmsg_edit_item title frm_input_box edui-default with_counter counter_in append count" id="titleprelocal7">
                                                                            <label for="title" class="tips_global placeholder_tips edui-default" style="display:none">Bitte geben Sie hier einen Titel ein</label>
                                                                            <input id="german_title" name="german_title" type="text" placeholder="<%= lang.please_enter_a_title_here %>" class="frm_input js_title js_counter js_field edui-default"
                                                                                max-length="64">
                                                                            <input type="hidden" id="german_id" name="german_id" value="">
                                                                            <em class="frm_input_append frm_counter" style="display: none;">0/64</em>
                                                                        </div>

                                                                        <!-- 正文 -->
                                                                        <div class="editor_area edui-default">
                                                                            <div class="split_line edui-default"></div>
                                                                            <!-- 正文报错 -->

                                                                            <div class="edui-editor-iframeholder js_reprint_hide edui-default" style="padding: 20px;">
                                                                                <textarea id="german_content" name="german_contentText" placeholder="<%= lang.write_the_text_from_here %>" class="frm_textarea js_desc js_counter js_field"
                                                                                    max-length="1000" style="height: 236px;"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <!-- EBGIN 音频 -->
                                                                        <div id="audioprelocal7" class="appmsg_edit_item gap_left audio" style="padding-top: 20px;border-top: 1px solid #e7e7eb;">
                                                                            <label for="" class="frm_label">
                                                                                <strong class="title">
                                                                                    <%= lang.audio %>
                                                                                </strong>
                                                                                <p class="js_cover_tip tips gap_left"></p>
                                                                            </label>
                                                                            <div class="upload_wrap">
                                                                                <div class="js_reprint_hide">
                                                                                    <div class="upload_box  align_right">
                                                                                        <span class="upload_area webuploader-container">
                                                                                            <a id="" class="btn btn-primary js_audioupload" data-groupid="">
                                                                                                <%= lang.upload_local %>
                                                                                            </a>
                                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                                <input id="input-german" type="file" accept="audio/basic,audio/x-aiff,audio/x-mpeg,audio/x-pn/realaudio,audio/x-waw" style="display: none;">
                                                                                                <input type="hidden" id="german_audiourl" name="german_audiourl" value="">
                                                                                                <label for="input-german" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                                            </div>
                                                                                        </span>
                                                                                    </div>
                                                                                    &nbsp;&nbsp;
                                                                                    <a id="js_audio7dialog" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">
                                                                                        <%= lang.choose_from_audio_library %>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                            <div id="audiocontainer7" class="js_show_cover_pic_tips" style="border:1px solid #e7e7eb;margin-top:10px;padding:6px;">
                                                                                <span class="tips js_msg_content">
                                                                                    <%= lang.audio_display_area %>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                        <!-- END 音频 -->
                                                                    </div>

                                                                    <!-- 底部 -->
                                                                    <div id="edui1_bottombar" class="edui-editor-bottomContainer edui-default">
                                                                        <table class=" edui-default">
                                                                            <tbody class=" edui-default">
                                                                                <tr class=" edui-default">
                                                                                    <td id="edui1_elementpath" class="edui-editor-bottombar edui-default" style="display: none;"></td>
                                                                                    <td id="edui1_wordcount" class="edui-editor-wordcount edui-default" style="display: none;"></td>
                                                                                    <td id="edui1_scale" class="edui-editor-scale edui-default" style="display: none;">
                                                                                        <div class="edui-editor-icon edui-default"></div>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                    <div id="edui1_scalelayer" class="edui-default"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- END UEDITOR -->


                                                    <!-- <div class="appmsg_edit_title">发布附件编辑</div> -->

                                                    <!-- EBGIN 图片 -->
                                                    <div class="appmsg_edit_highlight_area js_readonly" id="imgprelocal">
                                                        <div class="appmsg_edit_title"></div>
                                                        <div class="appmsg_edit_item gap_left">
                                                            <label for="" class="frm_label">
                                                                <strong class="title">
                                                                    <%= lang.image %>
                                                                </strong>

                                                                <p class="js_cover_tip tips gap_left"></p>
                                                            </label>
                                                            <div class="upload_wrap">
                                                                <div class="js_reprint_hide" style="line-height: 1.5;">
                                                                    <div class="upload_box  align_right">
                                                                        <span class="upload_area webuploader-container">
                                                                            <a id="js_imageupload5933769553478692" class="btn btn-primary js_imgsupload" data-groupid="">
                                                                                <%= lang.upload_local %>
                                                                            </a>
                                                                            <ul class="upload_file_box" style="display:none"></ul>
                                                                            <div id="rt_rt_1c1s401ur1rvo5oacbl14f81tk6m" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 32px; overflow: hidden; bottom: auto; right: auto;">
                                                                                <input id="imgfile" type="file" name="avatar" multiple="multiple" accept="image/bmp,image/png,image/jpeg,image/jpg,image/gif"
                                                                                    style="display: none;">
                                                                                <input type="hidden" id="attachment_imgurl" name="attachment_imgurl" value="">
                                                                                <input type="hidden" id="attachment_id" name="attachment_id" value="">
                                                                                <label for="imgfile" style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                                                                            </div>
                                                                        </span>
                                                                    </div>
                                                                    <!-- <a id="js_selectCoverFromContent" href="javascript:void(0);" onclick="return false;" class="btn btn_upload">点击上传</a> -->
                                                                    &nbsp;&nbsp;
                                                                    <a id="js_imagedialog" href="#" data-toggle="modal" data-target="#imagslib" class="btn btn_upload">
                                                                        <%= lang.choose_from_the_Image_library %>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div class="js_show_cover_pic_tips" id="imgsarea" style="width:100%;min-height:200px;border:1px solid #e7e7eb;margin-top:10px;">
                                                                <span class="tips js_msg_content" id="imgareatip">
                                                                    <%= lang.image_display_area %>
                                                                </span>
                                                                <div class="weui-desktop-media__list-wrp">
                                                                    <!---->
                                                                    <ul class="weui-desktop-img-picker__list" id="imgpreviewUL">

                                                                    </ul>
                                                                    <!---->
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- END 图片 -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script>
        var hostoutprefix = window.location.protocol + '//' + window.location.host +'/storage';

        function ImgAreaShowData(datafiles) {       //attachment的图片区域显示图片
            console.log("传入图片",datafiles)
            var _iframeparent = window.parent;
            $("#imgareatip").remove();              // 清空显示提示  <span class="tips js_msg_content" id="imgareatip">图片显示区域</span>

            var imgsfiles = datafiles;
            var filedataUrlIdArr = []               // 新增加的UrlId 数组
            var imgurlvalArr = $("#attachment_imgurl").val().split(",");

            var exiseDocname = [];
            if (!(imgurlvalArr.length == 1 && imgurlvalArr[0] == "")) {     //查询附件中的图片与再次传入的图片是否有重复
                for (var c = 0; c < imgurlvalArr.length; c++) {
                    for (var d = imgsfiles.length - 1; d >= 0; d--) {
                        if (imgurlvalArr[c] == imgsfiles[d].fileUrl) {
                            exiseDocname.push(imgsfiles[d].newName + "  ");
                            imgsfiles.splice(d, 1);
                        }
                    }
                }
            }

            if (exiseDocname.length != 0) _iframeparent.SucErrinfo("3", '选择了已有的附件图片：' + exiseDocname.join());
            for (var i = 0; i < imgsfiles.length; i++) {
                if (imgsfiles[i] == null) {                                       //文件不存在
                    var imgsli = '<li class="weui-desktop-img-picker__item">' +
                        '<i role="img" aria-describedby="图片描述"  class="weui-desktop-img-picker__img-thumb" style="background-image:url(../images/failed.jpg)"></i>' +
                        '<strong class="weui-desktop-img-picker__img-title" >' + '文件不存在' + '</strong>' +
                        '<div class="cbp-vm-add" onclick="removeImgInputvalue(this , \'#attachment_imgurl\')" data-id="">' +
                        '<i class="glyphicon glyphicon-trash"></i></div>'
                    '</li>'
                } else {
                    var reahttpimg = hostoutprefix + imgsfiles[i].fileUrl                       //请求缩略图地址
                    var imgsli = '<li class="weui-desktop-img-picker__item">' +
                        '<i role="img" aria-describedby="图片描述"  class="weui-desktop-img-picker__img-thumb" style="background-image:url(' + reahttpimg + ')"></i>' +
                        '<strong class="weui-desktop-img-picker__img-title" title=' + imgsfiles[i].newName + '>' + imgsfiles[i].newName + '</strong>' +
                        '<div class="cbp-vm-add" onclick="removeImgInputvalue(this , \'#attachment_imgurl\')" data-id=' + imgsfiles[i].fileUrl + '>' +
                        '<i class="glyphicon glyphicon-trash"></i></div>'
                    '</li>'

                    filedataUrlIdArr[i] = imgsfiles[i].fileUrl;                 //Url地址数组
                }
                $("#imgpreviewUL").append(imgsli);
            }


            var curimgurlval;
            if (imgurlvalArr.length == 1 && imgurlvalArr[0] == "") {            //整合UrlId数组
                curimgurlval = filedataUrlIdArr.join();
            } else {
                curimgurlval = imgurlvalArr.concat(filedataUrlIdArr).join();
            }
            $("#attachment_imgurl").val(curimgurlval);
        }

        function scrollrefreshbottom() {
            $("#body")[0].scrollTop = 0;
            $("#body").removeData();
            // $('#myScrollspy').scrollspy('refresh');
            $('#body').scrollspy('refresh');
            // $("#imgprelocal").scrollspy('activate');
            // $("#scroll3")[0].click();  
            // $('#scroll3').scrollspy('process');
            // $('#body').scrollspy({ target: '#myScrollspy' });
            $("#body")[0].scrollTop = $("#body")[0].scrollHeight;
            // var xxxx = $('#body').scrollspy('getScrollHeight');
            // console.log("yuans:", xxxx, "\n", $("#body")[0].scrollHeight)
        }

        function AudioAreaShowData(data) {                                      //从音频库选择的图片显示在attachment区域
            var _iframeparent = window.parent;
            var inputid = $('#audioslib', window.parent.document).attr("data-inputid");         //从父页面ifream属性获取是哪个语言的按钮打开了模态框
            var audioAreaid = $('#audioslib', window.parent.document).attr("data-audioAreaid");
            inputid = "#" + inputid;
            audioAreaid = "#" + audioAreaid;
            var audiofile = data;
            var audiofileaddress = hostoutprefix + audiofile.fileUrl;

            var audiodiv = '<div style="border: 0px solid #ddd;">' +
                '<span class="file-audio-content" style="padding:8px;cursor: pointer;" onclick="controlAudioplay(this)" title="Play">' +
                '<audio class="kv-preview-data file-preview-audio">您的浏览器不支持 audio 标签!' +
                '<source src=' + audiofileaddress + ' type=' + audiofile.mimetype + '>' +
                '</audio>' +
                '<div class="audioplay" style="width:56px;height:56px;"></div>' +
                '</span>' +
                '<span class="file-audio-content file-thumbnail-footer" style="width:calc(70% - 72px);" title=' + audiofile.newName + '>' + audiofile.newName + '</span>' +
                '<span class="file-audio-content audio_meta audio_length" style="width: calc(25% - 72px);">' + audiofile.duration + '</span>' +
                '<span class="file-audio-content file-actions">' +
                '<div class="file-footer-buttons">' +
                '<button id="deleaudio" type="button" onclick="removeAudioInputvalue(\'' + audioAreaid + '\',\'' + inputid + '\')" class="kv-file-remove btn" title="Remove file" data-key="100" style="background: #f4f5f900;padding: 0;min-width: 27px;margin-top: -5px;height: 30px;">' +
                '<i class="icon18_common del_blue"></i>' +
                '</button>' +
                '</div></span></div>';
            $(audioAreaid).find("audio")[0] = null;         //清空之前audio文件的载入
            $(audioAreaid).html(audiodiv);
            $(inputid).val(audiofile.fileUrl);              //存储音频Url地址

        }

        function removeAudioInputvalue(adudiohtmlid, inputid) {
            $(adudiohtmlid).html('<span class="tips js_msg_content"><%= lang.audio_display_area %></span>');
            $(inputid).val("");
            Savebtnstatus();                         //判断数据是否变化来残废保存按钮
        }
        function removeImgInputvalue(divremove, inputid) {
            var tar = $(divremove).attr("data-id");         //删除input中被对应的删除id值
            if (tar == "") {                                  //文件不存在
                $(divremove).parent().remove();             //删除预览图片
                return
            }
            var cururlArr = $(inputid).val().split(",");
            var delindex;
            for (var i = 0; i < cururlArr.length; i++) {
                if (cururlArr[i] == tar) {
                    delindex = i;
                }
            }
            cururlArr.splice(delindex, 1);
            var cururl = cururlArr.join();
            $(inputid).val(cururl);

            var lilength = $(divremove).parent().parent().find("li").length;    //在this删除前执行
            $(divremove).parent().remove();                                     //删除预览图片
            if (lilength == 1) $("#imgsarea").prepend('<span class="tips js_msg_content" id="imgareatip"><%= lang.image_display_area %></span>');    //没有图片的情况下显示提示
            Savebtnstatus();                         //判断数据是否变化来残废保存按钮
        }

        function uploadlocalAudio(audioinputID, audiocontainerID, audioUrlID) {
            var fileObj = $(audioinputID)[0].files;
            if (fileObj.length == 0) return
            var formFile = new FormData();
            formFile.append("files", fileObj[0]);
            // console.log("传送的文件：", fileObj[0])
            $.ajax({
                url: "../file/upload",
                data: formFile,
                type: "post",
                dataType: "json",
                cache: false,           //上传文件无需缓存
                processData: false,     //用于对data参数进行序列化处理 这里必须false  chinese_audiourl
                contentType: false,     //必须
                success: function (result) {
                    var audiofile = result.files[0];
                    var audiofileaddress = hostoutprefix + audiofile.fileUrl;

                    var audiodiv = '<div style="border: 0px solid #ddd;">' +
                        '<span class="file-audio-content" style="padding:8px;cursor: pointer;" onclick="controlAudioplay(this)" title="Play">' +
                        '<audio class="kv-preview-data file-preview-audio">您的浏览器不支持 audio 标签!' +
                        '<source src=' + audiofileaddress + ' type=' + audiofile.mimetype + '>' +
                        '</audio>' +
                        '<div class="audioplay" style="width:56px;height:56px;"></div>' +
                        '</span>' +
                        '<span class="file-audio-content file-thumbnail-footer" style="width:calc(70% - 72px);" title=' + audiofile.newName + '>' + audiofile.newName + '</span>' +
                        '<span class="file-audio-content audio_meta audio_length" style="width: calc(25% - 72px);">...</span>' +
                        '<span class="file-audio-content file-actions">' +
                        '<div class="file-footer-buttons">' +
                        '<button id="deleaudio" type="button" onclick="removeAudioInputvalue(\'' + audiocontainerID + '\',\'' + audioUrlID + '\')" class="kv-file-remove btn" title="Remove file" data-key="100" style="background: #f4f5f900;padding: 0;min-width: 27px;margin-top: -5px;height: 30px;">' +
                        '<i class="icon18_common del_blue"></i>' +
                        '</button>' +
                        '</div></span></div>';

                    $(audiocontainerID).find("audio")[0] = null;        //清空之前的audio文件载入
                    $(audiocontainerID).html(audiodiv);
                    $(audioUrlID).val(audiofile.fileUrl);

                    var audioexample = new Audio(audiofileaddress);
                    audioexample.addEventListener("canplaythrough", function () {
                        var tlentotalS = audioexample.duration;                                     //总秒数
                        var tlenM = Math.floor(tlentotalS / 60);
                        tlenM < 10 ? tlenM = "0" + tlenM : tlenM;
                        var tlenSdeci = (tlentotalS - Math.floor(tlentotalS / 60) * 60);            //带小数点     
                        var tlenS = Math.floor(tlenSdeci);
                        tlenS < 10 ? tlenS = "0" + tlenS : tlenS;
                        var tlenMS = tlenM + ':' + tlenS;                                           //分：秒
                        $(audiocontainerID).find(".audio_length").html(tlenMS);
                        audioexample = null
                    }, false)
                    // console.log("音频上传完成后返回的数据：", result);
                    Savebtnstatus();                                    //判断数据是否变化来残废保存按钮

                },
                error: function (data, status) {
                    if (status == 'error') {
                        // console.log("响应失败！");
                        window.parent.SucErrinfo("0", "上传失败,请稍后再试！");
                    }
                }
            })
        }

        function langsfillstatus(datainformation , status) {
            // console.log("附件信息:",datainformation)
            var filled = "";                //有内容的语言li选项
            var unfilled = "";              //无内容的语言li选项

            var attachments = datainformation.attachment.attachments
            for (i in attachments) {
                switch (attachments[i].lang) {
                    case "zh-CN":
                        var chinese_id = attachments[i]._id;
                        var chinese_title = attachments[i].title;
                        var chinese_audiourl = attachments[i].audio;
                        var chinese_content = attachments[i].text;
                        if ((chinese_title && chinese_title != "") || (chinese_audiourl && chinese_audiourl != "") || (chinese_content && chinese_content != "")) {
                            filled += '<li class="tpl_item active" data-index="1" data-lang="chinese" tabindex="-1">' +
                                '<a href="#beacon_right_1" class="langsdivcss fillexcite" data-toggle="tab" aria-expanded="true">' +
                                '中文</a>' +
                                '</li>'
                        } else {
                            unfilled += '<li class="tpl_item active" data-index="1" data-lang="chinese" tabindex="-1">' +
                                '<a href="#beacon_right_1" class="langsdivcss" data-toggle="tab" aria-expanded="true">' +
                                '中文</a>' +
                                '</li>'
                        }
                        //active状态手机预览有用到
                        break;
                    case "en-US":
                        var english_id = attachments[i]._id;
                        var english_title = attachments[i].title;
                        var english_audiourl = attachments[i].audio;
                        var english_content = attachments[i].text;
                        if ((english_title && english_title != "") || (english_audiourl && english_audiourl != "") || (english_content && english_content != "")) {
                            filled += '<li class="tpl_item " data-index="2" data-lang="english" tabindex="-1">' +
                                '<a href="#beacon_right_2" class="langsdivcss fillexcite" data-toggle="tab" aria-expanded="false">' +
                                'English</a>' +
                                '</li>'
                        } else {
                            unfilled += '<li class="tpl_item " data-index="2" data-lang="english" tabindex="-1">' +
                                '<a href="#beacon_right_2" class="langsdivcss" data-toggle="tab" aria-expanded="false">' +
                                'English</a>' +
                                '</li>'
                        }

                        break;
                    case "ja-JP":
                        var japanese_id = attachments[i]._id;
                        var japanese_title = attachments[i].title;
                        var japanese_audiourl = attachments[i].audio;
                        var japanese_content = attachments[i].text;
                        if ((japanese_title && japanese_title != "") || (japanese_audiourl && japanese_audiourl != "") || (japanese_content && japanese_content != "")) {
                            filled += '<li class="tpl_item " data-index="3" data-lang="japanese" tabindex="-1">' +
                                '<a href="#beacon_right_3" class="langsdivcss fillexcite" data-toggle="tab" aria-expanded="false">' +
                                '日本語</a>' +
                                '</li>'
                        } else {
                            unfilled += '<li class="tpl_item " data-index="3" data-lang="japanese" tabindex="-1">' +
                                '<a href="#beacon_right_3" class="langsdivcss" data-toggle="tab" aria-expanded="false">' +
                                '日本語</a>' +
                                '</li>'
                        }

                        break;
                    case "pt-BR":
                        var portuguese_id = attachments[i]._id;
                        var portuguese_title = attachments[i].title;
                        var portuguese_audiourl = attachments[i].audio;
                        var portuguese_content = attachments[i].text;
                        if ((portuguese_title && portuguese_title != "") || (portuguese_audiourl && portuguese_audiourl != "") || (portuguese_content && portuguese_content != "")) {
                            filled += '<li class="tpl_item " data-index="4" data-lang="portuguese" tabindex="-1">' +
                                '<a href="#beacon_right_4" class="langsdivcss fillexcite" data-toggle="tab" aria-expanded="false">' +
                                'Português</a>' +
                                '</li>'
                        } else {
                            unfilled += '<li class="tpl_item " data-index="4" data-lang="portuguese" tabindex="-1">' +
                                '<a href="#beacon_right_4" class="langsdivcss" data-toggle="tab" aria-expanded="false">' +
                                'Português</a>' +
                                '</li>'
                        }

                        break;
                    case "ru-RU":
                        var russian_id = attachments[i]._id;
                        var russian_title = attachments[i].title;
                        var russian_audiourl = attachments[i].audio;
                        var russian_content = attachments[i].text;
                        if ((russian_title && russian_title != "") || (russian_audiourl && russian_audiourl != "") || (russian_content && russian_content != "")) {
                            filled += '<li class="tpl_item " data-index="5" data-lang="russian" tabindex="-1">' +
                                '<a href="#beacon_right_5" class="langsdivcss fillexcite" data-toggle="tab" aria-expanded="false">' +
                                'Русский</a>' +
                                '</li>'
                        } else {
                            unfilled += '<li class="tpl_item " data-index="5" data-lang="russian" tabindex="-1">' +
                                '<a href="#beacon_right_5" class="langsdivcss" data-toggle="tab" aria-expanded="false">' +
                                'Русский</a>' +
                                '</li>'
                        }

                        break;
                    case "fr-FR":
                        var france_id = attachments[i]._id;
                        var france_title = attachments[i].title;
                        var france_audiourl = attachments[i].audio;
                        var france_content = attachments[i].text;
                        if ((france_title && france_title != "") || (france_audiourl && france_audiourl != "") || (france_content && france_content != "")) {
                            filled += '<li class="tpl_item " data-index="6" data-lang="france" tabindex="-1">' +
                                '<a href="#beacon_right_6" class="langsdivcss fillexcite" data-toggle="tab" aria-expanded="false">' +
                                'Français</a>' +
                                '</li>'
                        } else {
                            unfilled += '<li class="tpl_item " data-index="6" data-lang="france" tabindex="-1">' +
                                '<a href="#beacon_right_6" class="langsdivcss" data-toggle="tab" aria-expanded="false">' +
                                'Français</a>' +
                                '</li>'
                        }

                        break;
                    case "de-DE":
                        var german_id = attachments[i]._id;
                        var german_title = attachments[i].title;
                        var german_audiourl = attachments[i].audio;
                        var german_content = attachments[i].text;
                        if ((german_title && german_title != "") || (german_audiourl && german_audiourl != "") || (german_content && german_content != "")) {
                            filled += '<li class="tpl_item " data-index="7" data-lang="german" tabindex="-1">' +
                                '<a href="#beacon_right_7" class="langsdivcss fillexcite" data-toggle="tab" aria-expanded="false">' +
                                'Deutsch</a>' +
                                '</li>'
                        } else {
                            unfilled += '<li class="tpl_item " data-index="7" data-lang="german" tabindex="-1">' +
                                '<a href="#beacon_right_7" class="langsdivcss" data-toggle="tab" aria-expanded="false">' +
                                'Deutsch</a>' +
                                '</li>'
                        }

                        break;
                }
            }
            if (filled == "") {
                $("#langs").html(unfilled);
            } else if (unfilled == "") {
                $("#langs").html(filled);
            } else {
                $("#langs").html(filled + '<li class="divider"></li>' + unfilled);
            }

            var curchecklang = $("#langsdrop").attr("data-lang");
            // $('#langs li:eq(0) a').tab('show');             //选择中文
            if(status == 'save') $('#langs li[data-lang='+ curchecklang +']').addClass("active").siblings().removeClass("active")      //选择current lang

            $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {             //在标签页完全显示后执行的事件
                // console.log(e.target);
                var elem = $(e.target);
                var curtab = elem.attr("href");

                var scollheight = $(curtab + " .frm_textarea")[0].scrollHeight;     //标签页在隐藏的状态下获取不到scrollHeight,textarea自适应第一次执行时隐藏的文本框设置不了高度
                var minheight = $(curtab + " .frm_textarea").css("height").replace(/px/, "");
                if (scollheight > minheight) $(curtab + " .frm_textarea")[0].style.height = scollheight + "px";      //兼容IE

                $("#body").removeData();
                refreashscrollspy();                  //刷新滚动监视
            })

            $('a[data-toggle="tab"]').on('show.bs.tab', function (e) {              //在标签页显示前执行的事件
                var curval = $(e.target).parent().text();
                $("#langsdrop").html(curval + '<span class="caret"></span>');

                var curdatalang = $(e.target).parent().attr("data-lang");           //增加选中信息
                $("#langsdrop").attr("data-lang",curdatalang);

                $(e.target).parent().siblings().removeClass("active");
                var scollindex = $(e.target).parent().attr("data-index");
                var curlang = $(e.target).attr("href");                             //改变滚动监听地址

                $("#scroll1").attr("href", "#beacon_right_" + scollindex)
                $("#scroll2").attr("href", "#audioprelocal" + scollindex)

                $("#body")[0].scrollTop = 0 + "px";                                    //切换语言时，滚动条置顶（标签页与滚动监视同时使用有问题）
            })
        }

        function showpreviewContent(datainfo) {              //预览beacon的附件信息
            // console.log("附件信息：", datainfo);
            $("#beacon_id").val(datainfo.id);                //beaconID
            langsfillstatus(datainfo);                                               //判断语言内容是否存在,填充相应语言选项
            var attachments = datainfo.attachment.attachments
            for (i in attachments) {
                switch (attachments[i].lang) {
                    case "zh-CN":
                        var chinese_id = attachments[i]._id;
                        var chinese_title = attachments[i].title;
                        var chinese_audiourl = attachments[i].audio;
                        var chinese_content = attachments[i].text;

                        ShowPreviewAudio("#audiocontainer1", "#chinese_audiourl", chinese_audiourl);

                        $("#chinese_id").val(chinese_id);
                        $("#chinese_title").val(chinese_title);
                        // $("#chinese_audiourl").val(english_audiourl);
                        $("#chinese_content").val(chinese_content);
                        break;
                    case "en-US":
                        var english_id = attachments[i]._id;
                        var english_title = attachments[i].title;
                        var english_audiourl = attachments[i].audio;
                        var english_content = attachments[i].text;

                        ShowPreviewAudio("#audiocontainer2", "#english_audiourl", english_audiourl);

                        $("#english_id").val(english_id);
                        $("#english_title").val(english_title);
                        // $("#english_audiourl").val(english_audiourl);
                        $("#english_content").val(english_content);
                        break;
                    case "ja-JP":
                        var japanese_id = attachments[i]._id;
                        var japanese_title = attachments[i].title;
                        var japanese_audiourl = attachments[i].audio;
                        var japanese_content = attachments[i].text;

                        ShowPreviewAudio("#audiocontainer3", "#japanese_audiourl", japanese_audiourl);


                        $("#japanese_id").val(japanese_id);
                        $("#japanese_title").val(japanese_title);
                        // $("#japanese_audiourl").val(japanese_audiourl);
                        $("#japanese_content").val(japanese_content);
                        break;
                    case "pt-BR":
                        var portuguese_id = attachments[i]._id;
                        var portuguese_title = attachments[i].title;
                        var portuguese_audiourl = attachments[i].audio;
                        var portuguese_content = attachments[i].text;

                        ShowPreviewAudio("#audiocontainer4", "#portuguese_audiourl", portuguese_audiourl);

                        $("#portuguese_id").val(portuguese_id);
                        $("#portuguese_title").val(portuguese_title);
                        // $("#portuguese_audiourl").val(portuguese_audiourl);
                        $("#portuguese_content").val(portuguese_content);


                        break;
                    case "ru-RU":
                        var russian_id = attachments[i]._id;
                        var russian_title = attachments[i].title;
                        var russian_audiourl = attachments[i].audio;
                        var russian_content = attachments[i].text;

                        ShowPreviewAudio("#audiocontainer5", "#russian_audiourl", russian_audiourl);

                        $("#russian_id").val(russian_id);
                        $("#russian_title").val(russian_title);
                        // $("#russian_audiourl").val(russian_audiourl);
                        $("#russian_content").val(russian_content);

                        break;
                    case "fr-FR":
                        var france_id = attachments[i]._id;
                        var france_title = attachments[i].title;
                        var france_audiourl = attachments[i].audio;
                        var france_content = attachments[i].text;

                        ShowPreviewAudio("#audiocontainer6", "#france_audiourl", france_audiourl);

                        $("#france_id").val(france_id);
                        $("#france_title").val(france_title);
                        // $("#france_audiourl").val(france_audiourl);
                        $("#france_content").val(france_content);
                        break;
                    case "de-DE":
                        var german_id = attachments[i]._id;
                        var german_title = attachments[i].title;
                        var german_audiourl = attachments[i].audio;
                        var german_content = attachments[i].text;

                        ShowPreviewAudio("#audiocontainer7", "#german_audiourl", german_audiourl);

                        $("#german_id").val(german_id);
                        $("#german_title").val(german_title);
                        // $("#german_audiourl").val(german_audiourl);
                        $("#german_content").val(german_content);
                        break;
                    default:                                   //全不通过则为图片数据
                        var attachment_id = attachments[i]._id;
                        var attachment_imgurl = attachments[i].image.split(",");

                        var _iframe = window.parent;
                        if (attachment_imgurl[0] != "") {
                            $.ajax({
                                url: '../file/filesinformation',
                                type: 'GET',
                                data: { filesId: attachment_imgurl },
                                success: function (data) {
                                    // console.log("文件信息请求成功！");
                                    ImgAreaShowData(data.data);                  //将数据传输到attachment页面
                                    $("#attachment_id").val(attachment_id);

                                    setOrgFormdata();                            //保存当前表单数据,异步
                                },
                                error: function (err, status) {                  //请求失败也保存文件数据到input
                                    _iframe.SucErrinfo("0", "附件图片请求失败，请稍后再试！")
                                    $("#attachment_imgurl").val(attachment_imgurl.join());
                                    $("#attachment_id").val(attachment_id);

                                    setOrgFormdata();                            //保存当前表单数据,异步
                                }
                            })
                        } else {
                            $("#attachment_id").val(attachment_id);
                            setOrgFormdata();                                    //保存当前表单数据
                        }
                }
            }
            
        }

        function ShowPreviewAudio(audiocontainerID, audioUrlID, fileid) {            //获取预览音频文件的信息
            var _iframe = window.parent;

            if (fileid != "" && fileid) {                                            //没有音频文件则不进行任何操作,lang-id在标题上
                var fileinfoID = fileid.split(',');
                $.ajax({
                    url: '../file/filesinformation',
                    type: 'GET',
                    data: { filesId: fileinfoID },
                    success: function (data) {
                        // console.log("文件信息请求成功！");
                        var audiofile = data.data[0];
                        if (audiofile == null) {
                            _iframe.SucErrinfo("0", "文件不存在或已经被删除！");
                            var audiodiv = '<div style="border: 0px solid #ddd;height:74px;line-height: 74px;text-align: center;color:#777;">文件不存在或已被删除,请重新上传或从Audio库中选择。</div>';
                        } else {
                            var audiofileaddress = hostoutprefix + audiofile.fileUrl;
                            var audiodiv = '<div style="border: 0px solid #ddd;">' +
                                '<span class="file-audio-content" style="padding:8px;cursor: pointer;" onclick="controlAudioplay(this)" title="Play">' +
                                '<audio class="kv-preview-data file-preview-audio">您的浏览器不支持 audio 标签!' +
                                '<source src=' + audiofileaddress + ' type=' + audiofile.mimetype + '>' +
                                '</audio>' +
                                '<div class="audioplay" style="width:56px;height:56px;"></div>' +
                                '</span>' +
                                '<span class="file-audio-content file-thumbnail-footer" style="width:calc(70% - 72px);" title=' + audiofile.newName + '>' + audiofile.newName + '</span>' +
                                '<span class="file-audio-content audio_meta audio_length" style="width: calc(25% - 72px);">...</span>' +
                                '<span class="file-audio-content file-actions">' +
                                '<div class="file-footer-buttons">' +
                                '<button id="deleaudio" type="button" onclick="removeAudioInputvalue(\'' + audiocontainerID + '\',\'' + audioUrlID + '\')" class="kv-file-remove btn" title="Remove file" data-key="100" style="background: #f4f5f900;padding: 0;min-width: 27px;margin-top: -5px;height: 30px;">' +
                                '<i class="icon18_common del_blue"></i>' +
                                '</button>' +
                                '</div></span></div>';
                            $(audioUrlID).val(audiofile.fileUrl);        //audio 的URL ID值
                        }
                        $(audiocontainerID).html(audiodiv);

                        var audioexample = new Audio(audiofileaddress);
                        audioexample.addEventListener("canplaythrough", function () {
                            var tlentotalS = audioexample.duration;                                     //总秒数
                            var tlenM = Math.floor(tlentotalS / 60);
                            tlenM < 10 ? tlenM = "0" + tlenM : tlenM;
                            var tlenSdeci = (tlentotalS - Math.floor(tlentotalS / 60) * 60);            //带小数点     
                            var tlenS = Math.floor(tlenSdeci);
                            tlenS < 10 ? tlenS = "0" + tlenS : tlenS;
                            var tlenMS = tlenM + ':' + tlenS;                                           //分：秒
                            $(audiocontainerID).find(".audio_length").html(tlenMS);
                            audioexample = null
                        }, false)

                        setOrgFormdata();                            //保存当前表单数据,异步

                    },
                    error: function (err, status) {                  //请求失败也保存文件数据到input
                        _iframe.SucErrinfo("0", "附件音频请求失败，请稍后再试！");
                        $(audioUrlID).val(fileinfoID[0]);            //audio 的URL ID值

                        setOrgFormdata();                            //保存当前表单数据,异步
                    }
                })
            }
        }

        function setOrgFormdata() {
            $("#body").attr("data-content", getdata());         //保存当前表单数据，ajax是异步
        }

        function getdata() {                                    //获取表单数据
            var data = $("#form_tourbeacon_attachment").serialize();
            return data
        }

        function hideattachtip() {
            var orgcontent = $("#body").attr("data-content");   //原始表单数据
            var data = getdata();                               //当前表单数据
            if (orgcontent != data) {
                return true
            } else {
                return false
            }
        }

        function controlAudioplay(obj) {                        //音频播放/暂停控制
            var _iframe = window.parent;

            var audio = $(obj).find("audio")[0];
            var audiotype = $(obj).find("audio source").attr("type");
            if (audio.canPlayType(audiotype) == "probably") {   //浏览器是否支持音频格式
                if (audio.paused) {
                    audio.play();
                    $(obj).find("div").removeClass('audioplay').addClass('audiopause').attr("title", "Pause");
                } else {
                    audio.pause();
                    $(obj).find("div").removeClass('audiopause').addClass('audioplay').attr("title", "Play");
                }
            } else {
                _iframe.SucErrinfo("3", "您的浏览器不支持" + audiotype + "格式的音频播放！");
            }
        }

        function iPhonepreviewdata() {                                         //获取当前语言下的数据
            var _iframe = window.parent;

            var data = $("#form_tourbeacon_attachment").serializeArray();      //当前表单数据

            var serializeObj = {};
            $(data).each(function () {
                serializeObj[this.name] = this.value;
            });
            var langindex = $("#langs li.active").attr("data-lang");

            var audioid = serializeObj[langindex + "_audiourl"];
            var imgsid = serializeObj['attachment_imgurl'];

            if (audioid == "" || imgsid == "") return false                   //判断是否符合预览条件

            var findidarr = imgsid.split(",");
            findidarr[findidarr.length] = audioid;

            var resdata = {};
            var status = true;
            $.ajax({
                url: '../file/filesinformation',
                type: 'GET',
                async: false,
                data: { filesId: findidarr },
                success: function (filedata) {

                    resdata['title'] = serializeObj[langindex + "_title"];
                    resdata['contentText'] = serializeObj[langindex + "_contentText"];
                    resdata['audiourl'] = filedata.data[filedata.data.length - 1];
                    filedata.data.splice(filedata.data.length - 1, 1);                  //删除音频数据
                    resdata['attachment_imgurl'] = filedata.data;

                },
                error: function (err) {
                    _iframe.SucErrinfo("0", "文件信息获取请求失败，请稍后再试！")
                    status = false
                }
            })
            if (status) return resdata
        }

        function textareaactive() {
            $(".frm_textarea").each(function () {               //给textarea绑定高度自适应方法
                autoTextarea($(this)[0]);
            })
        }

        function autoTextarea(elem, extra, maxHeight) {         //textarea文本框高度自适应
            extra = extra || 0;
            var isFirefox = !!document.getBoxObjectFor || 'mozInnerScreenX' in window,
                isOpera = !!window.opera && !!window.opera.toString().indexOf('Opera'),
                addEvent = function (type, callback) {
                    elem.addEventListener ?
                        elem.addEventListener(type, callback, false) :
                        elem.attachEvent('on' + type, callback);
                },
                getStyle = elem.currentStyle ? function (name) {
                    var val = elem.currentStyle[name];

                    if (name === 'height' && val.search(/px/i) !== 1) {
                        var rect = elem.getBoundingClientRect();
                        return rect.bottom - rect.top -
                            parseFloat(getStyle('paddingTop')) -
                            parseFloat(getStyle('paddingBottom')) + 'px';
                    };

                    return val;
                } : function (name) {
                    return getComputedStyle(elem, null)[name];
                },
                minHeight = parseFloat(getStyle('height'));

            elem.style.resize = 'none';

            var change = function () {
                var scrollTop, height,
                    padding = 0,
                    style = elem.style;

                if (elem._length === elem.value.length) return;
                elem._length = elem.value.length;

                if (!isFirefox && !isOpera) {
                    padding = parseInt(getStyle('paddingTop')) + parseInt(getStyle('paddingBottom'));
                };
                scrollTop = document.body.scrollTop || document.documentElement.scrollTop;

                if (minHeight == 0) return;
                elem.style.height = minHeight + 'px';
                if (elem.scrollHeight > minHeight) {
                    if (maxHeight && elem.scrollHeight > maxHeight) {
                        height = maxHeight - padding;
                        style.overflowY = 'auto';
                    } else {
                        height = elem.scrollHeight - padding;
                        style.overflowY = 'hidden';
                    };
                    style.height = height + extra + 'px';
                    scrollTop += parseInt(style.height) - elem.currHeight;
                    document.body.scrollTop = scrollTop;
                    document.documentElement.scrollTop = scrollTop;
                    elem.currHeight = parseInt(style.height);
                };
            };

            addEvent('propertychange', change);
            addEvent('input', change);
            addEvent('focus', change);
            change();
        };


        function divbodyHeightreset() {
            var attachIfraemheight = $('#tour_attachment', window.parent.document).attr("height");
            // attachIfraemheight > 550 ? $("#body").css("height", "550px") : $("#body").css("height", "459px");
            $("#body").css("height", attachIfraemheight - 50 + "px");
        }

        function refreashscrollspy() {
            $("#body").removeData();
            // $('#myScrollspy').scrollspy('refresh');
            $('#body').scrollspy('refresh');
            $("#body").removeData();
            // $('#body').scrollspy({ target: '#myScrollspy' });
        }

        function Savebtnstatus() {
            var curdata = getdata();
            var orgdata = $("#body").attr("data-content");
            if (curdata != orgdata) {
                $("#saveattachment").removeAttr("disabled");                        //将确定按钮激活
                $("#saveattachment").parent().removeClass("btn_disabled");
            } else {
                $("#saveattachment").attr("disabled", "disabled");                  //将确定按钮残废
                $("#saveattachment").parent().addClass("btn_disabled");
            }
        }


        $(function () {                                     //附件页每隐藏一次 ifream都会重新加载一次

            // $('#langs li:eq(0) a').tab('show');             //选择中文

            $('#body').scrollspy();


            $("#form_tourbeacon_attachment :input").on("input", function () {
                Savebtnstatus();                         //判断数据是否变化来残废保存按钮
                // console.log("监视附件input");
            })

            $("#saveattachment").click(function () {    //保存按钮保存attachment数据
                var _iframe = window.parent;
                var curdata = getdata();
                $.ajax({
                    url: '../beacon/attachment/update',
                    type: 'POST',
                    data: curdata,
                    success: function (data) {
                        _iframe.SucErrinfo("1", "tour attachment update success！");
                        setOrgFormdata()             //设置新的原始表单数据
                        _iframe.doQueryBeacon();     //刷新表格
                        Savebtnstatus()              //残废保存按钮

                        langsfillstatus(data.result , "save") //页面不关闭时，更新langs li列表
                    },
                    error: function () {
                        _iframe.SucErrinfo("0", "tour attachment update fail！please try again later")
                    }
                });
            })

            divbodyHeightreset();                                            //改变attachment模态框的#body元素高度

            window.parent.attachmenSubmit(getdata);                          //监视点击提交时的上传事件  传入数据

            window.parent.attachmentMoadlhidecontrol(hideattachtip);         //隐藏附件模态框时进行form表单内容是否改变的判断

            window.parent.monitoriphonepreview(iPhonepreviewdata);           //监听预览点击按钮事件，传入数据

            // window.parent.attachShown(setOrgFormdata);                       //监听附件模态框完全打开事件，保留初始form值

            // window.parent.attachwindowresize(divbodyHeightreset);            //监听tour页面的窗口大小变化事件，改变attachment模态框的#body元素高度(IE不兼容)

            $("#js_imagedialog").on("click", function () {
                var _iframe = window.parent;
                _iframe.modalIO("show");
            })

            $("#js_audio1dialog").on("click", function () {     //chinese audio lib
                var _iframe = window.parent;
                _iframe.AudioModalIO("show", 'chinese_audiourl', 'audiocontainer1');
            })

            $("#js_audio2dialog").on("click", function () {     //english audio lib
                var _iframe = window.parent;
                _iframe.AudioModalIO("show", 'english_audiourl', 'audiocontainer2');
            })

            $("#js_audio3dialog").on("click", function () {     //japanese audio lib
                var _iframe = window.parent;
                _iframe.AudioModalIO("show", 'japanese_audiourl', 'audiocontainer3');
            })

            $("#js_audio4dialog").on("click", function () {     //Portuguese audio lib
                var _iframe = window.parent;
                _iframe.AudioModalIO("show", 'portuguese_audiourl', 'audiocontainer4');
            })

            $("#js_audio5dialog").on("click", function () {     //Russian audio lib
                var _iframe = window.parent;
                _iframe.AudioModalIO("show", 'russian_audiourl', 'audiocontainer5');
            })

            $("#js_audio6dialog").on("click", function () {     //Russian audio lib
                var _iframe = window.parent;
                _iframe.AudioModalIO("show", 'france_audiourl', 'audiocontainer6');
            })

            $("#js_audio7dialog").on("click", function () {     //Russian audio lib
                var _iframe = window.parent;
                _iframe.AudioModalIO("show", 'german_audiourl', 'audiocontainer7');
            })



            $("#input-chinese").on("change", function () {      //中文本地上传
                uploadlocalAudio("#input-chinese", "#audiocontainer1", "#chinese_audiourl");
            })

            $("#input-english").on("change", function () {      //英文本地上传
                uploadlocalAudio("#input-english", "#audiocontainer2", "#english_audiourl");
            })

            $("#input-japanese").on("change", function () {     //日文本地上传
                uploadlocalAudio("#input-japanese", "#audiocontainer3", "#japanese_audiourl");
            })

            $("#input-portuguese").on("change", function () {   //葡萄牙文本地上传
                uploadlocalAudio("#input-portuguese", "#audiocontainer4", "#portuguese_audiourl");
            })

            $("#input-russian").on("change", function () {      //俄罗斯文本地上传
                uploadlocalAudio("#input-russian", "#audiocontainer5", "#russian_audiourl");
            })

            $("#input-france").on("change", function () {      //法文本地上传
                uploadlocalAudio("#input-france", "#audiocontainer6", "#france_audiourl");
            })

            $("#input-german").on("change", function () {      //德文本地上传
                uploadlocalAudio("#input-german", "#audiocontainer7", "#german_audiourl");
            })

            $("#imgfile").on("change", function () {
                // console.log($("#imgfile"))
                var fileObj = $("#imgfile")[0].files;
                if (fileObj.length == 0) return
                var formFile = new FormData();
                for (var i = 0; i < fileObj.length; i++) {
                    formFile.append("files", fileObj[i]);
                }

                // formFile.append("files", fileObj); //加入文件对象 
                // console.log("传送的文件：", fileObj)
                $.ajax({
                    url: "../file/upload",
                    data: formFile,
                    type: "post",
                    dataType: "json",
                    cache: false,               //上传文件无需缓存
                    processData: false,         //用于对data参数进行序列化处理 这里必须false
                    contentType: false,         //必须  result.files
                    success: function (result) {
                        console.log("图片上传完成后返回的数据：", result,window.location.host)
                        ImgAreaShowData(result.files);
                        Savebtnstatus();                         //判断数据是否变化来残废保存按钮
                    },
                    error: function (data, status) {
                        if (status == 'error') {
                            // console.log("响应失败！")
                            window.parent.SucErrinfo("0", "文件上传失败,请稍后再试！");
                        }
                    }
                })

            })





        })
    </script>
</body>

</html>